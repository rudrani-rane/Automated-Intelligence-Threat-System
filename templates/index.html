<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ATIS - Mission Control</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Inter:wght@300;400;500;600&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-content">
            <div class="logo">üõ∞Ô∏è ATIS</div>
            <ul class="nav-links">
                <li><a href="/" class="active">Home</a></li>
                <li><a href="/galaxy">Galaxy</a></li>
                <li><a href="/radar">Radar</a></li>
                <li><a href="/watchlist">Watchlist</a></li>
                <li><a href="/trajectory">Trajectory</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container" style="margin-top: 100px;">
        <!-- Hero Section -->
        <div style="text-align: center; margin-bottom: 64px;">
            <h1>Automated Threat Intelligence System</h1>
            <p style="font-size: 1.125rem; color: rgba(255,255,255,0.8);">
                Planetary Defense Mission Control ‚Ä¢ Real-Time NEO Monitoring
            </p>
        </div>

        <!-- Status Cards -->
        <div class="grid grid-3" style="margin-bottom: 48px;">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">System Status</h3>
                    <div class="status-indicator">
                        <div class="status-dot active"></div>
                        <span>OPERATIONAL</span>
                    </div>
                </div>
                <div class="card-body">
                    <div style="font-family: var(--font-mono); font-size: 0.875rem;">
                        <div style="margin-bottom: 8px;">AI Model: <span style="color: var(--threat-safe);">ACTIVE</span></div>
                        <div style="margin-bottom: 8px;">Graph Network: <span style="color: var(--threat-safe);">LOADED</span></div>
                        <div style="margin-bottom: 8px;">Live Updates: <span style="color: var(--threat-safe);">STREAMING</span></div>
                        <div>Data Latency: <span style="color: var(--warning);">~150ms</span></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Threat Overview</h3>
                    <span class="badge badge-high">MONITORING</span>
                </div>
                <div class="card-body">
                    <div style="font-family: var(--font-mono); font-size: 0.875rem;">
                        <div style="margin-bottom: 8px;">Total Objects: <span style="color: var(--electric-blue);">12,056</span></div>
                        <div style="margin-bottom: 8px;">High Risk: <span style="color: var(--danger);">24</span></div>
                        <div style="margin-bottom: 8px;">PHAs: <span style="color: var(--warning);">2,347</span></div>
                        <div>Safe: <span style="color: var(--threat-safe);">9,685</span></div>
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Live Data Feed</h3>
                    <div class="status-indicator">
                        <div class="status-dot active"></div>
                        <span id="updateCounter">0 updates</span>
                    </div>
                </div>
                <div class="card-body">
                    <div style="font-family: var(--font-mono); font-size: 0.875rem;">
                        <div style="margin-bottom: 8px;">Source: <span style="color: var(--electric-blue);">JPL SBDB</span></div>
                        <div style="margin-bottom: 8px;">Update Interval: <span style="color: var(--electric-blue);">30s</span></div>
                        <div style="margin-bottom: 8px;">Last Update: <span id="lastUpdate">Loading...</span></div>
                        <div>Next Update: <span id="nextUpdate">--:--</span></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Quick Access Cards -->
        <h2 style="margin-bottom: 24px;">Mission Control Modules</h2>
        <div class="grid grid-4" style="margin-bottom: 48px;">
            <a href="/galaxy" style="text-decoration: none;">
                <div class="card" style="cursor: pointer;">
                    <h3 style="margin-bottom: 16px;">üåå 3D Galaxy</h3>
                    <p style="font-size: 0.875rem; color: rgba(255,255,255,0.7);">Real-time 3D visualization of NEO orbital space with threat-based coloring</p>
                </div>
            </a>
            
            <a href="/radar" style="text-decoration: none;">
                <div class="card" style="cursor: pointer;">
                    <h3 style="margin-bottom: 16px;">üì° Earth Radar</h3>
                    <p style="font-size: 0.875rem; color: rgba(255,255,255,0.7);">Proximity analysis visualization showing MOID vs threat correlation</p>
                </div>
            </a>
            
            <a href="/watchlist" style="text-decoration: none;">
                <div class="card" style="cursor: pointer;">
                    <h3 style="margin-bottom: 16px;">‚ö†Ô∏è Watchlist</h3>
                    <p style="font-size: 0.875rem; color: rgba(255,255,255,0.7);">Auto-updating ranked table of highest priority threat objects</p>
                </div>
            </a>
            
            <a href="/trajectory" style="text-decoration: none;">
                <div class="card" style="cursor: pointer;">
                    <h3 style="margin-bottom: 16px;">üõ∏ Trajectory</h3>
                    <p style="font-size: 0.875rem; color: rgba(255,255,255,0.7);">AI-powered orbital path detection and close approach forecasting</p>
                </div>
            </a>
            
            <a href="/ml-dashboard" style="text-decoration: none;">
                <div class="card" style="cursor: pointer;">
                    <h3 style="margin-bottom: 16px;">ü§ñ ML Dashboard</h3>
                    <p style="font-size: 0.875rem; color: rgba(255,255,255,0.7);">Model performance metrics, explainability, and anomaly detection</p>
                </div>
            </a>
            
            <a href="/multi-view" style="text-decoration: none;">
                <div class="card" style="cursor: pointer;">
                    <h3 style="margin-bottom: 16px;">üìä Multi-View</h3>
                    <p style="font-size: 0.875rem; color: rgba(255,255,255,0.7);">Synchronized multi-panel visualization dashboard</p>
                </div>
            </a>
            
            <a href="/analytics" style="text-decoration: none;">
                <div class="card" style="cursor: pointer;">
                    <h3 style="margin-bottom: 16px;">üìà Analytics</h3>
                    <p style="font-size: 0.875rem; color: rgba(255,255,255,0.7);">Comprehensive statistical analysis and orbital mechanics</p>
                </div>
            </a>
            
            <a href="/historical-timeline" style="text-decoration: none;">
                <div class="card" style="cursor: pointer;">
                    <h3 style="margin-bottom: 16px;">üìÖ Timeline</h3>
                    <p style="font-size: 0.875rem; color: rgba(255,255,255,0.7);">Historical and future close approach analysis (1900-2100)</p>
                </div>
            </a>
            
            <a href="/user-dashboard" style="text-decoration: none;">
                <div class="card" style="cursor: pointer;">
                    <h3 style="margin-bottom: 16px;">üë§ User Dashboard</h3>
                    <p style="font-size: 0.875rem; color: rgba(255,255,255,0.7);">Personal watchlist, alerts, and account settings</p>
                </div>
            </a>
        </div>

        <!-- Recent Alerts -->
        <div class="card">
            <div class="card-header">
                <h3 class="card-title">Recent High-Priority Detections</h3>
                <button class="btn btn-secondary" style="padding: 8px 16px; font-size: 0.75rem;" onclick="location.href='/watchlist'">View All</button>
            </div>
            <div class="card-body">
                <div id="recentAlerts" style="font-family: var(--font-mono); font-size: 0.875rem;">
                    Loading recent detections...
                </div>
            </div>
        </div>
    </div>

    <script>
        // Update timestamp
        function updateTimestamp() {
            const now = new Date();
            document.getElementById('lastUpdate').textContent = now.toLocaleTimeString();
            
            const nextUpdate = new Date(now.getTime() + 30000);
            document.getElementById('nextUpdate').textContent = nextUpdate.toLocaleTimeString();
        }
        
        updateTimestamp();
        setInterval(updateTimestamp, 1000);
        
        // Fetch recent alerts
        fetch('/api/watchlist')
            .then(res => res.json())
            .then(data => {
                const alertsDiv = document.getElementById('recentAlerts');
                const watchlist = data.watchlist || [];
                const topAlerts = watchlist.slice(0, 5);
                
                if (topAlerts.length > 0) {
                    alertsDiv.innerHTML = topAlerts.map((item, idx) => `
                        <div style="padding: 12px; margin-bottom: 8px; background: rgba(0,191,255,0.05); border-left: 3px solid ${item.threat_score > 0.7 ? '#ff0000' : item.threat_score > 0.4 ? '#ffa500' : '#00ff7f'}; border-radius: 4px;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <a href="${item.url}" target="_blank" style="color: #00bfff; text-decoration: none; font-weight: 500;">
                                        #${idx + 1} - ${item.name} ‚Üó
                                    </a>
                                    <div style="font-size: 0.75rem; color: rgba(255,255,255,0.5); margin-top: 2px;">
                                        SPKID: ${item.spkid}
                                    </div>
                                </div>
                                <span class="badge ${item.threat_score > 0.7 ? 'badge-critical' : item.threat_score > 0.4 ? 'badge-high' : 'badge-medium'}">
                                    ${(item.threat_score * 100).toFixed(1)}%
                                </span>
                            </div>
                        </div>
                    `).join('');
                } else {
                    alertsDiv.innerHTML = '<p style="color: rgba(255,255,255,0.5);">No high-priority threats detected</p>';
                }
            })
            .catch(err => {
                document.getElementById('recentAlerts').innerHTML = '<p style="color: var(--danger);">Error loading alerts</p>';
            });
    </script>
</body>
</html>